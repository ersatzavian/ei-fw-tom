<!DOCTYPE html>
    <html lang='en'>
      <head>
        <meta charset='utf-8'>
        <meta name='viewport' content='width=device-width, initial-scale=1.0'>
        <meta name='description' content=''>
        <meta name='author' content=''>
    
        <title>Tracker</title>
        <link href="data:image/x-icon;base64,AAABAAEAEBAAAAAAAABoBQAAFgAAACgAAAAQAAAAIAAAAAEACAAAAAAAAAEAAAAAAAAAAAAAAAEAAAAAAAAAAAAACEajAPr6+gAAAgUABzuKACdlwgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMEAQEBAAAAAAAAAAAAAAMEBAEBAQEBAAAAAAAAAAMEBAQBAgICAQEAAAAAAAMEBAQEAQMCAwIBAQEAAAAEBAQEBAECAwICAQEBAQAABAQEBAQBAgIDAgEBAQEBAAQEBAQEAQMDAgIBAQEBAQADBAQEAQECAgMCAQEBAQEABAQEBAUFAQECAgEBAQEBAAQEBAUFBQUFAQEBAQEBAQAEBAUBAQEFBQUFBQEBAQEABAUFBQUBAQEFBQUFBQEBAAUFBQUFBQUFAQEBBQUFBQAAAAUFBQUFBQUFBQEBBQAAAAAAAAAFBQUFBQUFBQAAAAAAAAAAAAAABQUFAAAAAPB/AADgHwAAwA8AAIADAACAAQAAgAAAAIAAAACAAAAAgAAAAIAAAACAAAAAgAAAAIAAAADgAQAA/AMAAP+PAAA=" rel="icon" type="image/x-icon" />
        <link href='https://netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css' rel='stylesheet'>
    
      </head>
      <body>

        <nav id='top' class='navbar navbar-static-top navbar-inverse' role='navigation'>
          <div class='container'>
            <div class='navbar-header'>
              <button type='button' class='navbar-toggle' data-toggle='collapse' data-target='.navbar-ex1-collapse'>
                <span class='sr-only'>Toggle navigation</span>
                <span class='icon-bar'></span>
                <span class='icon-bar'></span>
                <span class='icon-bar'></span>
              </button>
              <a class='navbar-brand'>Package Tracker</a>
            </div>
    
            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class='collapse navbar-collapse navbar-ex1-collapse'>
              <ul class='nav navbar-nav'>
              </ul>
            </div><!-- /.navbar-collapse -->
          </div><!-- /.container -->
        </nav>
        
        <div class='container'>
          <div class='row' style='margin-top: 20px'>
            <div class='col-md-offset-2 col-md-8 well'>
                <h3>Currently Tracking:</h3>
                <div class='row' style = 'margin-top: 20px; margin-bottom: 20px; margin-left:5px; margin-right: 5px;'>
                    <ul id='trackers' class="list-group"></ul>
                </div>
                <div class='input-group'>
                    <input type='text' class='form-control' id='newTracker'>
                    <span class='input-group-btn'>
                        <button class='btn btn-default' type='button' onClick='addTracker();'>Track Package</button>
                    </span>
                </div>
            </div>
          </div>
          <hr>
    
          <footer>
            <div class='row'>
              <div class='col-lg-12'>
                <p class='text-center'>Copyright &copy; Electric Imp 2013 &middot; <a href='http://facebook.com/electricimp'>Facebook</a> &middot; <a href='http://twitter.com/electricimp'>Twitter</a></p>
              </div>
            </div>
          </footer>
          
        </div><!-- /.container -->
    
      <!-- javascript -->
      <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.0.3/jquery.min.js'></script>
      <script src='https://netdna.bootstrapcdn.com/bootstrap/3.0.2/js/bootstrap.min.js'></script>
      <script>
      
        //var getListURL= document.URL+'/list';'
        var getListURL = 'http://agent.electricimp.com/XePTZZPX2aOw/list';
        //var addURL = document.URL+'/track';
        var addURL = 'http://agent.electricimp.com/XePTZZPX2aOw/add';
        //var removeURL = document.URL+'/remove';
        var removeURL = 'http://agent.electricimp.com/XePTZZPX2aOw/remove';

        function removeTracker(who) {
            var tracker = who.parent().children('.trackingid').html();
            $.ajax({
                type: 'POST',
                url: removeURL,
                data: tracker,
                success: function() {
                    who.parent().remove();
                }
            })
        }

        function addTracker() {
            var tracker = $('#newTracker').val();
            $.ajax({
                type: 'POST', 
                url: addURL,
                data: tracker,
                success: function() {
                    var listEl = $('#trackers');
                    listEl.append(createListItem(tracker));
                    $('#newTracker').val('');
                }
            })
        }
    
        $(document).ready(function() {
            $.ajax({
                type: 'GET',
                url: getListURL,
                success: function(dataString) { 
                    var data = $.parseJSON(dataString);
                    for(var key in data) {
                        var listEl = $('#trackers');
                        listEl.append(createListItem(key));
                    }
                }
            })
        });

        function createListItem(key) {
             return listItem = '<li class=\'list-group-item\'><span class=\'trackingid\'>' + key + '</span><button type=\'button\' class=\'btn btn-default btn-sm pull-right\' style=\'margin-top: -5px;\' onClick=\'removeTracker($(this));\'><span class=\'glyphicon glyphicon-remove-sign\'></span></button></li>';
        }
    
      </script>
    </body>    
</html>