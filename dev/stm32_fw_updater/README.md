STM32 bootloader class for Electric Imp
==============================
This class allows you to connect an Electric Imp to an external STM32 processor and execute the commands provided in the USART bootloader command set on the STM32. For more information on the STM32 Memory Boot Mode, see [ST AN2606](http://www.st.com/st-web-ui/static/active/en/resource/technical/document/application_note/CD00167594.pdf). 

This class implements the command set detailed in [ST AN3155](http://www.st.com/web/en/resource/technical/document/application_note/CD00264342.pdf).

##Updating Application Code on the STM32 with the Imp

### Convert 

Here are the magic words to convert an intel HEX file (generated by Keil, for example) into a raw binary file ready to be uploaded directly to the STM32. You will need to install the srecord library:

```
14:21:33-tom$ brew install srecord
```

Get your compiler to generate a HEX output file, then convert it with srec_cat:

```
14:26:44-tom$ srec_cat blinky-fast.hex -intel -offset - -minimum-addr blinky-fast.hex -intel -o blinky-fast.bin -binary
```

Note that failing to include the offset by minimum address will create an obscenely large file and make you sad.

### Push directly to the agent

```
14:20:12-tom$ curl --data-binary @blinky.bin https://agent.electricimp.com/<ID>/push
```

### Tell the agent to fetch the file

Include the file length and source url as query parameters:

```
14:20:12-tom$ curl --data-binary @blinky.bin https://agent.electricimp.com/<ID>/fetch?len=2268&addr=<my_server>/blinky.bin
```